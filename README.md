# Chess

## research
- vercel kv python
- chessboardjs options
- data urls
- chess llm post
- lru cache impl
- extend pdb
- ui layout
- parallel ideas
- py typing checks
- mac cpu stats & clock time
- vercel perf stats


## TODO
- rules
  - must move out of check
  - enp pin
  - insufficient material
  - randomize with n pieces
  - illegal pos if it's your turn and no moves to make
  - pawn vectors

- minimax player
  - lookahead tree
  - minimax impl
  - alpha beta pruning
  - position ct instead of depth
  - tree ordering
  - load/save player

- profile: perf & mem/caching
  - setup jupyter notebook for testing
  - benchmark.py
    - print timeits for all major functions
  - play archive loop with -n param & cProfile
  - self-play loop w stats
    - cli args
    - total time
    - num games
    - w/l/d ratio
    - games/sec
    - moves/sec
    - moves/game -> min, max, avg, var
    - moves evaluated per position
    - cache stats (hits, size)
    - avg pos score w/b
    - avg end score w/b
    - avg legal moves per position
    - wins vs self or random player
    - savings from pruning
    - avg number of attacked pieces/squares -> contact amount
      - track over course of game
  - define baseline metrics
    - what is the distribution of position scores?
    - min/max/avg moves per game (archive vs random)
    - moves calculated by avg minimax search (w pruning)
    - how important is 50 move rule & 3-fold rep?
    - memory per board state
    - cache hit/miss perf
    - num cache calls per move
    - king capture differences
    - time to get legal moves
    - time to get attacks
    - time for end state calculation
    - time for material score calculation (tricks?)
    - time for minimax
    - number of moves evaluated
    - extra time for pin/check eval
    - extra time for lookahead by cloning game (vs undo move)
    - big O for minimax -> b^(d/2) -> b=avg moves to check, d=depth
    - what percentage of random positions are legal?
      - for n pieces on the board, what is the total state space?
  - define goals (g/s or m/s, memory, etc)
  - garbage collection debugging
  - archive test & timing
  - profiler
  - timeits
  - flop calc
  - mem reqs, adjust cache
  - htop etc - research
  - try:
    - basic
      - bitboards
      - fen optim -> diff? bits->fen?
      - cache optim?
      - list comprehensions?
      - more tuples/frozen/sets etc
      - 1d board array
      - back to recursion
      - numpy
      - cpython
      - mojo
    - lookahead/minimax
      - unmake move (or clone game instead of using fen)
      - king capture
      - pruning
      - order moves by capture, etc
    - parallel
      - process pool
      - gpu?
      - convolution approaches?

- UI/server
  - layout & pieces
  - dragging
  - illegal move (client?)
  - new game -> redirect to url
  - load game
  - make move & respond
  - illegal move (server)
  - game over
  - promotions
  - shuffle board
  - setup board?

## Algorithms
- minimax w pruning
- mcts
- q
- elo
- bitboards
- transformer
- tokenizer for transformer (notation)
- genetic (player hyperparams)
- dqn
- ppo
- mpc - model predictive control
- jepa
- star/quiet-star
- basic nn
- basic cnn
- ebm?! - energy-based model
- rlhf?
- a star?


## maybe
- offer draw
- pgn parser
- allow output of shortened notation
- adorn notation (check, etc.)
- requires promotion
- game debugger (step, print, etc)
- os github
